# What is Pelagius?

Pelagius is a Discord bot that was originally written for Evertiro's
LOTD Plus Skyrim modding guide. This later expanded to include
[Lexy's Legacy of the Dragonborn guide] as well as [The Phoenix Flavour].
Originally, the wasn't actually a bot at all, just me running a python
script manually to compare my own loadorder to that of other users when
they uploaded it. Naturally, the problem with that is that I have to be
there all the time to run my script. I then decided to start developing
a standalone Discord bot written in Discord.py to accomplish the same
thing, but automatically. I later switched over to Discord.js, as well
as implemented a few other features, such as being able to ignore certain
plugins in the list. However, that's the past. Let's talk about now and
the future.

## What does it do?

Basically it lets your users upload a loadorder.txt file and compare it to a
master file.

- Staff upload a "master" loadorder.txt to be compared to (generated by MO2)
- Users can upload a loadorder.txt and it will be analyzed
  - This analysis will tell them what plugins they shouldn't have and what
    they're missing compared to the master list
- Staff can pause and resume validation, useful for updates to the list
- Staff can upload a "skips" file which contains a list of plugins to ignore
- Staff can upload a "reasons" JSON file which is used to tell users why a
  certain plugin is missing or extra
- Properly supports multiple Discord servers, keeping staff lists and master
  files separate
- Supports multiple guides on a single server, and allows a "default" guide

## How do I set it up?

First, [click here to add Pelagius] to your server. Select the server you want
to add the bot to, and ensure that the check boxes for the "Send Messages,"
"Attach Files," and "Read Message History" permissions are selected. Finally,
click the "Authorize" button to add the bot to your server.

Once the bot has joined the server, you only need to do one thing: set up a
master file

- Get your [loadorder.txt] (generated by MO2) and upload it with the command
`/manage file upload loadorder`

That's it, Pelagius is ready to run!

If you want, you can also upload a "skips" and "reasons" file using the command
`/manage file upload [filetype]`.

- The [skips file] will ignore all listed filenames (files should be entered
one per line)
- The [reasons file] will provide reasons to your users as to why they shouldn't
have a certain file (it needs to be JSON)

## Can I run Pelagius as a service?

Yes! An [example service file] is included for your convenience. Copy it to your
systemd/user directory, run `systemctl --user daemon-reload` followed by
`systemctl --user start pelagius`.

Be sure to update the WorkingDirectory and ExecStart lines with the appropriate
paths! If you are using NVM, the ExecStart line should be run through `nvm-exec`
like so: `ExecStart=/path/to/.nvm/nvm-exec pnpm start`

## Complete command list

### /loadorder

The `/loadorder` command requires one argument, an attachment. This attached
file must be named `loadorder.txt`. There is an optional `guide` argument, to
specify what guide to compare your loadorder against. By default, this command
can be run by any user.

### /guides

The `/guides` command lists the guides that are available in the server, as
well as stating the default guide. If no guide argument is sent in a command,
it will use the default guide. By default, this command can be run by any user.

### /manage

The `/manage` command is the hub command for managing Pelagius as a staff
member. By default, members with the Manage Server permission can use these
commands.

#### /manage file

The `/manage file` subcommand group is for managing your files. You can upload
new files with `/manage file upload`, or retrieve existing files with
`/manage file retrieve`. You must specify what type of file, and may optionally
provide a guide to set the files for.

#### /manage guide

The `/manage guide` subcommand group is for managing separate guides within
your server. You may `add`, `remove`, `rename`, and `list` guides easily.
`/manage guide default` will control what guide is the default for your
server. `/manage guide enable` will control if validation is enabled for a
specific guide or not.

If you ever wish to change permissions on a command, go to your
`Server Settings -> Integrations -> Pelagius` and see the command settings
there. You may also use this area to control which channels the commands
can be run in.

[Lexy's Legacy of the Dragonborn guide]: https://lexyslotd.com
[The Phoenix Flavour]: https://thephoenixflavour.com
[loadorder.txt]: example/loadorder.txt
[skips file]: example/skips.txt
[reasons file]: example/reasons.json
[example service file]: example/pelagius.service
[click here to add Pelagius]: https://discord.com/api/oauth2/authorize?client_id=714232981774139442&permissions=100352&scope=bot
